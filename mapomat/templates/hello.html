<!DOCTYPE html>
<html lang="en" ng-app="mapomat">
<head>
    <title>Map-o-Mat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- icon -->
    <link rel="icon" type="image/png"
    href="{{ url_for('static', filename='favicon-32x32.png') }}" sizes="32x32">
    <link rel="icon" type="image/png"
    href="{{ url_for('static', filename='favicon-96x96.png') }}" sizes="96x96">
    <link rel="icon" type="image/png"
    href= "{{ url_for('static', filename='favicon-16x16.png') }}"
    sizes="16x16">

    <!-- jQuery, bootstrap and angular -->
    <script type="text/javascript" src="{{url_for('static', filename='jQuery/jquery-2.1.4.min.js') }}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.4/angular.min.js"></script>
    <script src="https://cdn.rawgit.com/angular-ui/angular-ui/master/build/angular-ui.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- own styles -->
    <link rel='stylesheet' href="{{ url_for('static', filename='hello.css') }}">

    <!-- color picker -->
    <script type="text/javascript" src="{{url_for('static', filename='minicolors/angular-minicolors.js') }}"></script>
    <script type="text/javascript" src="{{url_for('static', filename='minicolors/jquery.minicolors.js') }}"></script>
    <link rel='stylesheet' href="{{ url_for('static', filename='minicolors/jquery.minicolors.css') }}">



    <!-- own scripts -->
    <script>
        // dynamically generated by the server, rest is client side
        window.cityCategories = {{ city_categories|tojson }}
        window.superCatNames = {{ super_categories|tojson }}
        window.subCatNames = {{ categories|tojson }}
        window.sendFormTo = "{{ url_for('hello') }}"
        window.resultsUrl = "{{ url_for('result', identifier="") }}"
    </script>
    <script src="{{ url_for('static', filename='mapomat.js') }}"></script>
</head>
<body>
    <div id="wrap">
    <div style="
    background-image: url('{{ url_for('static', filename='title_back.png')}}');
    margin-bottom: 1.5em; padding-bottom: 1.5em;"
    >
    <div class="container"
    style="max-width: 970px;">
        <img src="{{ url_for('static', filename='mapomat_title.svg') }}"
        class="img-responsive center-block"
        style="margin-top: 30px; margin-bottom: 30px" />
        <p style="background-color: rgba(255, 255, 255, 0.8);
        box-shadow: 0px 0px 30px 5px rgba(255,255,255,1);
        margin-bottom: 0px">
            Welcome to Map-o-Mat! This application uses the data published
            in the <a href="http://www.yelp.com/dataset_challenge">yelp
            dataset challenge</a> to automatically order businesses into
            categories (nothing you see here was picked by hand!) and
            display them on maps from
            <a href="https://www.arcgis.com/features/">ArcGIS</a>.<br />
            We are Hermann Blum and Alexander Dietmüller and developed this
            application as part of a group project for the
            <a href="http://disco.ethz.ch">disco group at ETH Zurich</a>.
            <br />
            To start, pick a city and all categories you want to see and
            click "generate". After a little computing this will take you
            to a live map preview.<br />
            (You can also download the overlay as .kml)
        </p>
    </div>
    </div>
    <div class="container">
        <form
        ng-controller="SelectController" ng-submit="sendForm()">
            {% raw %}
            <div class="row">
                <div class="col-md-4 col-md-offset-4">
                    <select name="city" class="form-control"
                    ng-model="selectedCity"
                    ng-change="selection = []">
                        <option ng-repeat="(city, dict) in cityCats"
                        value="{{ city }}">{{ city }}</option>
                        <option value="">-- select a city to start --</option>
                    </select>
                </div>
            </div>
            <br /><br />
            <div class="row">
                <div ng-repeat="(super, sublist) in cityCats[selectedCity]" >
                    <div ng-if="$index % 4 == 0" class="clearfix"></div>
                    <div class="col-md-3" style="margin-bottom: 1.5em">
                    <!--div class="clearfix"></div-->
                        <h4> {{ superNames[super] }} </h4>
                        <hr style="margin-top: 0.5em; margin-bottom: 0.5em;
                        background-color: rgb(51, 122, 183);
                        height: 1px;
                        color: rgb(51, 122, 183); border: none">

                        <input type="checkbox" name="supercat"
                        value="{{ super }}"
                        ng-model="selection[super]"
                        ng-click="updateColors()">
                            All Businesses
                        </input>
                        <div ng-repeat="sub in sublist">
                            <input type="checkbox" name="subcat"
                            value="({{super}}, {{sub}})"
                            ng-model="selection['[' + super + ', ' + sub + ']']"
                            ng-click="updateColors()">
                            <!-- super dirty hack where we have to produce some JSON to parse it later. shoudl think about other solution -->
                                {{ subNames[super][sub] }}
                            </input>
                        </div>
                    </div>
                </div>
            </div>
            <br \><br \>
            <div class="" ng-show="selectedCity">
                <div class="" ng-click="advancedOptions = !advancedOptions">
                    <span ng-hide="advancedOptions" class="glyphicon glyphicon-chevron-right" aria-hide="true"></span>
                    <span ng-show="advancedOptions" class="glyphicon glyphicon-chevron-down" aria-hide="true"></span>
                    &nbsp;Advanced Options
                </div>

                <hr style="margin-top: 0.5em; margin-bottom: 0.5em;
                        background-color: rgb(51, 122, 183);
                        height: 1px;
                        color: rgb(51, 122, 183); border: none" ng-show="advancedOptions">

                <div class="container-fluid" ng-show="advancedOptions" style="pading:1em; margin-top:1em">
                    <div class="row">
                    <div class="col-md-4">
                        <div class="radio" ng-repeat="scaling in scalings">
                            <label for="{{scaling.name}}"
                                class="scaling">
                                <input type="radio"
                                ng-model="$parent.selectedScaling"
                                ng-value="scaling.exp"
                                name="scaling-radios">

                                    {{ scaling.name }}

                                <div class="function-gradient">
                                    <div class="gradient-item" ng-repeat="val in scaling.values" style="background-color: rgb({{val}}, {{val}}, {{val}});">
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <!--div class="container-fluid"><div class="row"-->
                            <div class="col-md-6 color-object" ng-repeat="color in colors">
                                <!--div class="color-object"-->
                                    <div class="colorpicker-container">
                                        <input minicolors="pickerConfig"
                                        name="colors"
                                        ng-model="color.color"
                                        value="{{color.color}}"
                                        type="hidden"
                                        style="margin-left: 10px; width: 28px; height: 28px; float:left; "
                                        width="28px" height="28px"/>
                                    </div>
                                    <span class="color-description">{{color.name}}</span>
                                <!--/div-->
                            </div>
                        <!--/div></div-->
                    </div>
                    </div>
                </div>
            </div>
            {% endraw %}

            <button class="btn btn-primary btn-lg btn-block"
                    type="submit"
                    ng-show="selectedCity"
                    style="margin-top: 1.2em; margin-bottom: 1.2em"
                    formmethod="post">Generate</button>

        </form>
    </div>
    </div>
    <!--
    <div class="navbar navbar-default" id="footer"
    ng-controller="FooterController as fCtrl"
    ng-style="fCrl.footermargin"
    style="text-align: center; margin-bottom: 0px">
        <div class="container">
        <p class="navbar-text">Map-o-Mat by Hermann Blum and Alexander
        Dietmüller. Logo made with icons by
        <a href="http://www.flaticon.com/authors/freepik" title="Freepik">
        Freepik</a> from <a href="http://www.flaticon.com" title="Flaticon">
        www.flaticon.com</a>, licensed by
        <a href="http://creativecommons.org/licenses/by/3.0/"
        title="Creative Commons BY 3.0">CC BY 3.0</a>.
        <a href="http://getbootstrap.com">Bootstrap is used for the design</a>
        and <a href="https://angularjs.org">AngularJS</a> for the scripts.
        </p>
        </div>
    </div>
    -->
</body>
</html>
