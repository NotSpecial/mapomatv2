<!DOCTYPE html>
<html lang="en" ng-app="mapomat">
<head>
    <title>Map-o-Mat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- icon -->
    <link rel="icon" type="image/png"
    href="{{ url_for('static', filename='favicon-32x32.png') }}" sizes="32x32">
    <link rel="icon" type="image/png"
    href="{{ url_for('static', filename='favicon-96x96.png') }}" sizes="96x96">
    <link rel="icon" type="image/png"
    href= "{{ url_for('static', filename='favicon-16x16.png') }}"
    sizes="16x16">

    <!-- bootstrap and angular -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.4/angular.min.js"></script>
    <script src="https://raw.github.com/angular-ui/angular-ui/master/build/angular-ui.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <!-- color picker -->
    <script src="{{ url_for('static', filename='colorpicker/bootstrap-colorpicker-module.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='colorpicker/colorpicker.css') }}"

    <!-- own scripts -->
    <script>
        // dynamically generated by the server, rest is client side
        window.cityCategories = {{ city_categories|tojson }}
        window.superCatNames = {{ super_categories|tojson }}
        window.subCatNames = {{ categories|tojson }}
        window.sendFormTo = "{{ url_for('hello') }}"
    </script>
    <script src="{{ url_for('static', filename='mapomat.js') }}"></script>
</head>
<body>
    <div id="wrap">
    <div style="
    background-image: url('{{ url_for('static', filename='title_back.png')}}');
    margin-bottom: 1.5em; padding-bottom: 1.5em;"
    >
    <div class="container"
    style="max-width: 970px;">
        <img src="{{ url_for('static', filename='mapomat_title.svg') }}"
        class="img-responsive center-block"
        style="margin-top: 30px; margin-bottom: 30px" />
        <p style="background-color: rgba(255, 255, 255, 0.8);
        box-shadow: 0px 0px 30px 5px rgba(255,255,255,1);
        margin-bottom: 0px">
            Welcome to Map-o-Mat! This application uses the data published
            in the <a href="http://www.yelp.com/dataset_challenge">yelp
            dataset challenge</a> to automatically order businesses into
            categories (nothing you see here was picked by hand!) and
            display them on maps from
            <a href="https://www.arcgis.com/features/">ArcGIS</a>.<br />
            We are Hermann Blum and Alexander Dietmüller and developed this
            application as part of a group project for the
            <a href="http://disco.ethz.ch">disco group at ETH Zurich</a>.
            <br />
            To start, pick a city and all categories you want to see and
            click "generate". After a little computing this will take you
            to a live map preview.<br />
            (You can also download the overlay as .kml)
        </p>
    </div>
    </div>
    <div class="container">
        <form 
        ng-controller="SelectController" ng-submit="sendForm()">
            {% raw %}
            <div class="row">
                <div class="col-md-4 col-md-offset-4">
                    <select name="city" class="form-control"
                    ng-model="selectedCity">
                        <option ng-repeat="(city, dict) in cityCats"
                        value="{{ city }}">{{ city }}</option>
                        <option value="">-- select a city to start --</option>
                    </select>
                </div>
            </div>
            <br /><br />
            <div class="row">
                <div
                ng-repeat="(super, sublist) in cityCats[selectedCity]">
                    <div ng-if="$index % 4 == 0" class="clearfix"></div>
                    <div class="col-md-3" style="margin-bottom: 1.5em">
                        <h4> {{ superNames[super] }} </h2>
                        <hr style="margin-top: 0.5em; margin-bottom: 0.5em;
                        background-color: rgb(51, 122, 183);
                        height: 1px;
                        color: rgb(51, 122, 183); border: none">

                        <input type="checkbox" name="supercat"
                        value="{{ super }}"
                        ng-model="selection[super]"
                        ng-click="updateColors()"> 
                            all businesses
                        </input>
                        <div ng-repeat="sub in sublist">
                            <input type="checkbox" name="subcat"
                            value="({{super}}, {{sub}})"
                            ng-model="selection['[' + super + ', ' + sub + ']']"
                            ng-click="updateColors()">
                            <!-- super dirty hack where we have to produce some JSON to parse it later. shoudl think about other solution -->
                                {{ subNames[super][sub] }}
                            </input>
                            <!--
=======
                
                class="col-md-3">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            {{ superNames[super] }}
                        </div>
                        <div class="panel-body">

                            <input type="checkbox" name="supercat"
                            value="{{ super }}"
                            ng-model="selection[super]"
                            ng-click="updateColors()">
                                all businesses
                            </input>
                            <div ng-repeat="sub in sublist">
                                <input type="checkbox" name="subcat"
                                value="({{super}}, {{sub}})"
                                ng-model="selection['[' + super + ', ' + sub + ']']"
                                ng-click="updateColors()">
                            -->
                                <!-- super dirty hack where we have to produce some JSON to parse it later. shoudl think about other solution -->
                                <!--
                                {{ subNames[super][sub] }}
                                </input>
                            </div>
>>>>>>> advanced_options
-->
                        </div>
                    </div>
            </div>
            <br \><br \>
            <div class="row">
                <ul class="list-group">
                    <li class="list-group-item" ng-repeat="color in colors">
                        <div class="input-group">
                            <span class="input-group-addon">{{color.name}}</span>
                            <div class="input-group-addon" style="background-color: {{color.color}}; width: 100px;" ></div>
                            <input colorpicker colorpicker-position="right" type="text" ng-model="color.color" 
                            style="backgroud-color:{{color.color}}"
                            name="colors" value="{'key': {{color.key}}, 'color': {{color.color}} }"/>
                        </div>
                    </li>
                </ul>
            </div>
            {% endraw %}

            <button class="btn btn-primary btn-lg btn-block"
                    type="submit"
                    ng-show="selectedCity"
                    style="margin-top: 1.2em; margin-bottom: 1.2em"
                    formmethod="post">Generate</button>

        </form>
    </div>
    </div>
    <!--
    <div class="navbar navbar-default" id="footer"
    ng-controller="FooterController as fCtrl"
    ng-style="fCrl.footermargin"
    style="text-align: center; margin-bottom: 0px">
        <div class="container">
        <p class="navbar-text">Map-o-Mat by Hermann Blum and Alexander
        Dietmüller. Logo made with icons by
        <a href="http://www.flaticon.com/authors/freepik" title="Freepik">
        Freepik</a> from <a href="http://www.flaticon.com" title="Flaticon">
        www.flaticon.com</a>, licensed by
        <a href="http://creativecommons.org/licenses/by/3.0/"
        title="Creative Commons BY 3.0">CC BY 3.0</a>.
        <a href="http://getbootstrap.com">Bootstrap is used for the design</a>
        and <a href="https://angularjs.org">AngularJS</a> for the scripts.
        </p>
        </div>
    </div>
    -->
</body>
</html>
